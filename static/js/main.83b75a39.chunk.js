(this.webpackJsonpfacebook_client=this.webpackJsonpfacebook_client||[]).push([[0],{130:function(e,t,n){},131:function(e,t,n){},132:function(e,t,n){},133:function(e,t,n){},134:function(e,t,n){},135:function(e,t,n){},137:function(e,t,n){},138:function(e,t,n){},139:function(e,t,n){},140:function(e,t,n){},141:function(e,t,n){},142:function(e,t,n){},143:function(e,t,n){},147:function(e,t,n){},148:function(e,t,n){},149:function(e,t,n){},150:function(e,t,n){},151:function(e,t,n){},152:function(e,t,n){},153:function(e,t,n){},154:function(e,t,n){},155:function(e,t,n){},156:function(e,t,n){},157:function(e,t,n){},158:function(e,t,n){},172:function(e,t,n){},178:function(e,t,n){},179:function(e,t,n){"use strict";n.r(t),n.d(t,"socket",(function(){return wt}));var a=n(2),c=n.n(a),r=n(29),s=n.n(r),i=n(15),o=n(5),l=n(185),d=n(22),u="USER_REGISTER",j="USER_LOGIN",b="GET_ERRORS",p="CLEAR_ERRORS",h="GET_COMMENTS",m="ADD_COMMENT",f="GET_POSTS",O="ADD_POST",x="DELETE_COMMENT",v="UPDATE_COMMENT",y="ADD_COMMENT_REACTION",g="DELETE_COMMENT_REACTION",N="ADD_POST_REACTION",E="DELETE_POST_REACTION",F="DELETE_POST",C="UPDATE_POST",k="ENABLE_POST_FORM",_="DISABLE_POST_FORM",R="MAP_POST_TO_COMMENTS",S="UNMAP_POST_TO_COMMENTS",I="RESET_COMMENTS",w="RESET_POSTS",T="ENABLE_REACTIONS_LIST",A="DISABLE_REACTIONS_LIST",P="ENABLE_SIGNUP_FORM",L="DISABLE_SIGNUP_FORM",D="ADD_FRIEND_REQUEST",q="ADD_FRIEND",U="DELETE_FRIEND_REQUEST",M="DELETE_FRIEND",B="ADD_FRIEND_TO_AUTH",G="DELETE_FRIEND_FROM_AUTH",H="GET_FRIENDS",W="GET_ACTION",J="CLEAR_ACTION",V="UPDATE_USER",Q="ENABLE_UPLOAD_PICTURE",K="DISABLE_UPLOAD_PICTURE",Y=n(9),z=n.n(Y),X=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return function(n){n({type:k,payload:{post:e,profile:t}})}},Z=function(){return function(e){e({type:_})}},$=(n(130),n(4)),ee=n(16),te=(n(131),n(6)),ne=["comments"],ae=function(e){return function(t){var n={},a=e.reduce((function(e,t){var a=t.comments,c=Object(te.a)(t,ne);return n[t.id]=a,e.push(c),e}),[]);t({type:f,payload:a}),t({type:h,payload:n})}},ce=function(e,t){return function(n){z.a.post("/api/users/".concat(t,"/friends"),e).then((function(e){n({type:B,payload:e.data.friend}),n({type:U,payload:e.data.friend.id})})).catch((function(e){n({type:b,payload:e.response})}))}},re=function(e,t){return function(n){z.a.delete("/api/users/".concat(e,"/requests/").concat(t,"?decline=true")).then((function(e){n({type:U,payload:t}),n({type:W,payload:{type:U,payload:t}})})).catch((function(e){n({type:b,payload:e.response})}))}},se=function(e,t){return function(n){z.a.delete("/api/users/".concat(e,"/requests/").concat(t,"?unsend=true")).then((function(e){n({type:U,payload:t})})).catch((function(e){n({type:b,payload:e.response})}))}},ie=function(e,t){return function(n){z.a.delete("/api/users/".concat(e.username,"/friends/").concat(t)).then((function(a){n({type:M,payload:{userId:e.id,friendId:t}}),n({type:G,payload:t})})).catch((function(e){n({type:b,payload:e.response})}))}},oe=n(39),le=n(47);n(132);function de(e){var t=document.createElement("textarea");return t.innerHTML=e,t.value}var ue=function(e,t){return function(n){z.a.post("/api/reactions",e).then((function(e){t.post_id?(wt.emit("new reaction",{comment:t,reaction:e.data}),n({type:y,payload:{comment:t,reaction:e.data}})):(wt.emit("new reaction",{post:t,reaction:e.data}),n({type:N,payload:{post:t,reaction:e.data}}))})).catch((function(e){n({type:b,payload:e.response})}))}},je=function(e,t){return function(n){z.a.delete("/api/reactions/".concat(e._id)).then((function(a){t.post_id?(wt.emit("delete reaction",{comment:t,reaction:e}),n({type:g,payload:{comment:t,reaction:e}})):(wt.emit("delete reaction",{post:t,reaction:e}),n({type:E,payload:{post:t,reaction:e}}))})).catch((function(e){n({type:b,payload:e.response})}))}},be=(n(133),n(90)),pe=n(72),he=n(91),me=n(41),fe=(n(134),n(135),n(1));var Oe=Object(o.b)((function(e){return{comments:e.comments,auth:e.auth}}),{addComment:function(e){return function(t){z.a.post("/api/comments",e).then((function(e){wt.emit("new comment",e.data),t({type:m,payload:[e.data]})})).catch((function(e){console.log(e),t({type:b,payload:e.response})}))}}})((function(e){var t=e.type,n=e.parentId,c=e.postId,r=e.profileId,s=e.comments,i=e.addComment,o=e.isFocused,l=e.disableAddCommentFocus,d=e.auth,u=Object(a.useState)(""),j=Object($.a)(u,2),b=j[0],p=j[1],h=Object(a.useRef)();return Object(a.useEffect)((function(){p("")}),[s]),Object(a.useEffect)((function(){o&&h.current.focus()}),[o]),Object(fe.jsxs)("form",{onSubmit:function(e){e.preventDefault(),i({parentId:n,profileId:r,postId:c,content:b})},className:"add-comment-form",children:[Object(fe.jsx)("a",{href:"/".concat(d.user.username),rel:"author",className:"left",children:Object(fe.jsx)("img",{src:d.user.picture.url,alt:"user's profile avatar",className:"user-picture"})}),Object(fe.jsxs)("div",{className:"secondary-bg-color secondary-frame right",children:[Object(fe.jsx)("input",{type:"text",placeholder:"Write a ".concat(t,"..."),value:b,onChange:function(e){p(e.target.value)},onBlur:l,ref:h,required:!0}),Object(fe.jsx)("button",{type:"submit",style:{display:"none"}})]})]})})),xe=n(3);var ve=Object(o.b)(null,{updateComment:function(e){return function(t){z.a.put("/api/comments/".concat(e.id),{content:e.content}).then((function(e){wt.emit("update comment",e.data),t({type:v,payload:e.data})})).catch((function(e){t({type:b,payload:e.response})}))}}})((function(e){var t=e.comment,n=e.updateComment,c=e.toggleEditComment,r=Object(a.useState)(t),s=Object($.a)(r,2),i=s[0],o=s[1],l=Object(a.useRef)();return Object(a.useEffect)((function(){l.current.focus()}),[]),Object(fe.jsxs)("form",{onSubmit:function(e){e.preventDefault(),n(i)},className:"edit-comment-form",children:[Object(fe.jsxs)("div",{className:"secondary-bg-color tertiary-frame",children:[Object(fe.jsx)("input",{type:"text",placeholder:"Write a ".concat(i.post_id===i.parent_id?"comment":"reply","..."),value:de(i.content),onChange:function(e){var t=Object(xe.a)({},i);t.content=e.target.value,o(t)},onKeyDown:function(e){"Escape"===e.key&&c()},ref:l,required:!0}),Object(fe.jsx)("button",{type:"submit",style:{display:"none"}})]}),Object(fe.jsxs)("p",{className:"secondary-font-color left comment-btns",children:["Press Esc to\xa0",Object(fe.jsx)("button",{type:"button",onClick:c,className:"primary-font-color",children:"cancel"})]})]})})),ye=(n(137),n(23));function ge(e){var t=e.items;return Object(fe.jsxs)(ye.a,{className:"custom-dropdown secondary-font-color",children:[Object(fe.jsx)(ye.a.Toggle,{children:Object(fe.jsx)(oe.e,{className:"more-btn secondary-bg-color-hover"})}),Object(fe.jsx)(ye.a.Menu,{children:Object(fe.jsx)("ul",{children:t.map((function(e){return Object(fe.jsx)("li",{children:Object(fe.jsx)(ye.a.Item,{onClick:e.function,children:e.label})},Object(l.a)())}))})})]})}var Ne=["auth","parent","component"];var Ee=Object(o.b)((function(e){return{auth:e.auth}}))((function(e){var t=e.auth,n=e.parent,a=e.component,c=Object(te.a)(e,Ne);return Object(fe.jsx)(fe.Fragment,{children:t.user.id===n.author.id||t.user.id===n.destination_profile?Object(fe.jsx)(a,Object(xe.a)({},c)):null})})),Fe=(n(138),n(71));var Ce=Object(o.b)((function(e){return{posts:e.posts,comments:e.comments}}),{enableReactionsList:function(e){return function(t){t({type:T,payload:e})}}})((function(e){var t=e.reactions,n=e.enableReactionsList,a=e.hidden;return e.posts,e.comments,Object(fe.jsxs)("button",{className:"like-button",onClick:function(){n(t)},style:a?{visibility:"hidden"}:{},children:[Object(fe.jsx)("i",{className:"primary-font-color",children:Object(fe.jsx)(Fe.a,{})}),Object(fe.jsxs)("span",{className:"secondary-font-color",children:[" ",t.length]})]})}));var ke=Object(o.b)((function(e){return{comments:e.comments,auth:e.auth}}),{deleteComment:function(e){return function(t){z.a.delete("/api/comments/".concat(e.id)).then((function(n){wt.emit("delete comment",e),t({type:x,payload:e})})).catch((function(e){t({type:b,payload:e.response})}))}},addReaction:ue,deleteReaction:je,loadComments:function(e){return function(t){z.a.get("/api/comments?parentId=".concat(e)).then((function(e){t({type:m,payload:e.data})})).catch((function(e){t({type:b,payload:e.response})}))}}})((function(e){var t=e.data,n=e.comments,c=e.deleteComment,r=e.auth,s=e.addReaction,i=e.deleteReaction,o=e.loadComments,l=Object(a.useRef)(t),d=Object(a.useState)(!1),u=Object($.a)(d,2),j=u[0],b=u[1],p=Object(a.useState)(!1),h=Object($.a)(p,2),m=h[0],f=h[1];Object(a.useEffect)((function(){f(!1)}),[n]);var O=function(){var e=t.reactions.find((function(e){return e.author.id===r.user.id}));if(e)i(e,l.current);else{var n={parentId:l.current.id,profileId:l.current.destination_profile,value:"Like"};s(n,l.current)}},x=function(){f(!m)},v=[];t.replies.length>0&&n[t.post_id].length>0&&(v=n[t.post_id].filter((function(e){var n,a=Object(me.a)(t.replies);try{for(a.s();!(n=a.n()).done;){if(n.value.id===e.id)return!0}}catch(c){a.e(c)}finally{a.f()}return!1})));var y=[{label:"Delete",function:function(){c(l.current)}},{label:"Update",function:x}];return Object(fe.jsxs)("li",{className:"comment".concat(m?" edit":""),children:[m?Object(fe.jsx)(ve,{comment:l.current,toggleEditComment:x}):Object(fe.jsxs)("div",{className:"sub-wrapper",children:[Object(fe.jsxs)("div",{className:"sub-sub-wrapper",children:[Object(fe.jsx)("a",{href:"/".concat(t.author.username),rel:"author",children:Object(fe.jsx)("img",{src:t.author.picture.url,alt:"user's profile avatar",className:"user-picture"})}),Object(fe.jsxs)("div",{className:"comment-main secondary-bg-color tertiary-frame",children:[Object(fe.jsx)("a",{href:"/".concat(t.author.username),rel:"author",children:Object(fe.jsx)("h4",{children:t.author.name})}),Object(fe.jsx)("p",{children:de(t.content)}),Object(fe.jsx)(Ce,{reactions:t.reactions,hidden:0===t.reactions.length})]}),Object(fe.jsx)(Ee,{component:ge,parent:t,items:y})]}),Object(fe.jsxs)("div",{className:"comment-btns secondary-font-color",children:[Object(fe.jsxs)("div",{className:"left light-bold",children:[t.reactions.find((function(e){return e.author.id===r.user.id}))?Object(fe.jsx)("button",{onClick:O,className:"primary-font-color",children:"Unlike"}):Object(fe.jsx)("button",{onClick:O,children:"Like"}),Object(fe.jsx)("i",{children:"\xb7"}),Object(fe.jsx)("button",{onClick:function(){b(!0)},children:"Reply"})]}),Object(fe.jsx)("i",{children:"\xb7"}),Object(fe.jsx)("button",{className:"comment-date reg-display",children:Object(fe.jsx)("time",{dateTime:t.date,children:new Date(t.date).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})})})]})]}),t.replies.length>0&&v.length<t.replies.length&&Object(fe.jsxs)("div",{className:"more-comments-btn light-bold secondary-font-color",children:[Object(fe.jsx)(oe.b,{className:"arrow-icon"}),Object(fe.jsxs)("button",{onClick:function(){o(l.current.id)},children:["View ",t.replies.length-v.length," more ",t.replies.length-v.length>1?"replies":"reply"]})]}),v.length>0&&Object(fe.jsx)(_e,{comments:v}),j&&Object(fe.jsx)(Oe,{type:"reply",parentId:t.id,profileId:t.destination_profile,postId:t.post_id})]})}));n(139);function _e(e){var t=e.comments;return Object(fe.jsx)("ul",{className:t[0].post_id===t[0].parent_id?"comment-list":"reply-list",children:t.map((function(e){return Object(fe.jsx)(ke,{data:e},e.id)}))})}var Re=Object(o.b)((function(e){return{comments:e.comments,auth:e.auth,posts:e.posts}}),{addReaction:ue,deleteReaction:je,deletePost:function(e){return function(t){z.a.delete("/api/posts/".concat(e.id)).then((function(n){wt.emit("delete post",e),t({type:F,payload:e}),t({type:S,payload:e})})).catch((function(e){t({type:b,payload:e.response})}))}},enablePostForm:X})((function(e){var t,n=e.postIndex,c=e.comments,r=e.auth,s=e.addReaction,i=e.deleteReaction,l=e.deletePost,d=e.posts,u=e.enablePostForm,j=Object(a.useState)(0),p=Object($.a)(j,2),h=p[0],m=p[1],f=Object(a.useState)(!1),O=Object($.a)(f,2),x=O[0],v=O[1],y=Object(a.useState)(!0),g=Object($.a)(y,2),N=g[0],E=g[1],F=Object(o.c)(),C=function(){var e=d[n].reactions.find((function(e){return e.author.id===r.user.id}));if(e)i(e,d[n]);else{var t={parentId:d[n].id,profileId:d[n].destination_profile.id,value:"Like"};s(t,d[n])}};Object(a.useEffect)((function(){z.a.get("/api/comments?postId=".concat(d[n].id)).then((function(e){m(e.data.length)})).catch((function(e){F({type:b,payload:e})}))}),[c]);var k=[{label:"Delete",function:function(){l(d[n])}},{label:"Update",function:function(){u(d[n])}}];return Object(fe.jsxs)("li",{className:"post primary-frame primary-bg-color",children:[Object(fe.jsxs)("header",{children:[Object(fe.jsxs)("div",{className:"sub-header",children:[Object(fe.jsx)("a",{href:"/".concat(d[n].author.username),rel:"author",children:Object(fe.jsx)("img",{src:d[n].author.picture.url,alt:"user's profile avatar",className:"user-picture"})}),Object(fe.jsxs)("div",{children:[Object(fe.jsx)("a",{href:"/".concat(d[n].author.username),rel:"author",children:Object(fe.jsx)("h3",{children:d[n].author.name})}),Object(fe.jsx)("time",{dateTime:d[n].date,className:"post-date secondary-font-color",children:new Date(d[n].date).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})})]})]}),Object(fe.jsx)(Ee,{component:ge,parent:d[n],items:k})]}),Object(fe.jsx)("p",{className:"post-content",children:de(d[n].content)}),Object(fe.jsxs)("div",{className:"post-data secondary-font-color",children:[Object(fe.jsx)(Ce,{reactions:d[n].reactions,hidden:0===d[n].reactions.length}),h>0&&Object(fe.jsx)("button",{onClick:function(){E(!N)},children:"".concat(h," Comment").concat(h>1?"s":"")})]}),Object(fe.jsxs)("div",{className:"post-btns secondary-font-color light-bold",children:[d[n].reactions.find((function(e){return e.author.id===r.user.id}))?Object(fe.jsxs)("button",{onClick:C,className:"primary-font-color post-btn hovered-link",children:[Object(fe.jsx)("i",{children:Object(fe.jsx)(pe.b,{})}),Object(fe.jsx)("span",{children:"Unlike"})]}):Object(fe.jsxs)("button",{onClick:C,className:"post-btn hovered-link",children:[Object(fe.jsx)("i",{children:Object(fe.jsx)(be.a,{})}),Object(fe.jsx)("span",{children:"Like"})]}),Object(fe.jsxs)("button",{onClick:function(){v(!0)},className:"post-btn hovered-link",children:[Object(fe.jsx)("i",{children:Object(fe.jsx)(he.a,{})}),Object(fe.jsx)("span",{children:"Comment"})]})]}),N?(null===(t=c[d[n].id])||void 0===t?void 0:t.length)>0?Object(fe.jsx)(_e,{comments:c[d[n].id].filter((function(e){return e.parent_id===d[n].id}))}):Object(fe.jsx)("p",{className:"no-data-msg",children:"Be the first to comment."}):null,N?Object(fe.jsx)(Oe,{type:"comment",parentId:d[n].id,profileId:d[n].destination_profile.id,postId:d[n].id,isFocused:x,disableAddCommentFocus:function(){v(!1)}}):null]})}));function Se(e){var t=e.posts;return Object(fe.jsx)("ul",{children:t.map((function(e,t){return Object(fe.jsx)(Re,{postIndex:t},e.id)}))})}n(140);var Ie=Object(o.b)((function(e){return{auth:e.auth}}),{enablePostForm:X})((function(e){var t=e.user,n=e.auth,a=e.enablePostForm;return Object(fe.jsx)("section",{className:"add-post-section primary-frame primary-bg-color secondary-font-color",children:Object(fe.jsx)("button",{onClick:function(){a(null,t||n.user)},className:"secondary-bg-color secondary-frame secondary-bg-color-hover",children:t&&n.user.id!==t.id?"Write something to ".concat(t.first_name,"..."):"What's on your mind?"})})}));var we=Object(o.b)((function(e){return{posts:e.posts,friends:e.friends}}))((function(e){var t=e.user,n=e.friends,a=e.posts,c=Object.keys(n).map((function(e){return n[e]}));return Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)("section",{className:"snapshot",children:Object(fe.jsxs)("article",{className:"friends primary-frame primary-bg-color",children:[Object(fe.jsxs)("header",{children:[Object(fe.jsx)("h2",{children:"Friends"}),Object(fe.jsx)("p",{className:"friends-count secondary-font-color",children:"".concat(c.length," friend").concat(c.length>1?"s":"")})]}),c.length>0?Object(fe.jsx)("ul",{children:c.slice(0,9).map((function(e){return Object(fe.jsxs)("li",{children:[Object(fe.jsx)("a",{href:"/".concat(e.username),children:Object(fe.jsx)("img",{src:e.picture.url,alt:"user's profile avatar",className:"friend-picture"})}),Object(fe.jsx)("a",{href:"/".concat(e.username),children:Object(fe.jsx)("h6",{className:"light-bold",children:e.name})})]},e.username)}))}):Object(fe.jsx)("p",{className:"no-data-msg",children:"There is no one here."})]})}),Object(fe.jsxs)("section",{className:"profile-posts",children:[Object(fe.jsx)(Ie,{user:t}),Object(fe.jsxs)("section",{children:[Object(fe.jsx)("h2",{className:"primary-frame primary-bg-color",children:"Posts"}),a.length>0?Object(fe.jsx)(Se,{posts:a}):Object(fe.jsx)("p",{className:"no-data-msg",children:"You don't have any posts yet."})]})]})]})})),Te=(n(141),n(12));n(142);var Ae={sendFriendRequest:function(e,t){return function(n){z.a.post("/api/users/".concat(t,"/requests"),e).then((function(e){n({type:D,payload:e.data})})).catch((function(e){n({type:b,payload:e.response})}))}},deleteFriend:ie,addFriend:function(e,t){return function(n){z.a.post("/api/users/".concat(t,"/friends"),e).then((function(e){n({type:q,payload:e.data.user}),n({type:B,payload:e.data.friend}),n({type:U,payload:e.data.friend.id})})).catch((function(e){n({type:b,payload:e.response})}))}},cancelFriendRequest:se,declineFriendRequest:re},Pe=Object(o.b)((function(e){return{auth:e.auth,friends:e.friends}}),Ae)((function(e){var t=e.parent,n=e.auth,a=e.sendFriendRequest,c=e.deleteFriend,r=e.addFriend,s=e.declineFriendRequest,i=e.cancelFriendRequest,o=e.friends,l=e.shortVersion,d=function(){var e={friendId:t.id};a(e,n.user.username)},u=function(){c(n.user,t.id)},j=function(){var e={friendId:t.id};r(e,n.user.username)},b=function(){s(n.user.username,t.id)},p=function(){i(n.user.username,t.id)};return Object(fe.jsx)(fe.Fragment,{children:n.user.id!==t.id?!l&&o[n.user.id]?Object(fe.jsx)(Te.a,{onClick:u,children:"Unfriend"}):!l&&n.user.incomingFriendRequests[t.id]?Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)(Te.a,{onClick:j,children:"Accept request"}),Object(fe.jsx)(Te.a,{onClick:b,className:"reg-display",children:"Decline friend request"})]}):!l&&n.user.outgoingFriendRequests[t.id]?Object(fe.jsx)(Te.a,{onClick:p,children:"Cancel request"}):Object(fe.jsx)(Te.a,{onClick:d,children:"Add as friend"}):null})}));var Le=Object(o.b)((function(e){return{friends:e.friends,auth:e.auth}}),{deleteFriend:ie,deleteFriendFromAuth:function(e,t){return function(n){z.a.delete("/api/users/".concat(e.username,"/friends/").concat(t)).then((function(e){n({type:G,payload:t})})).catch((function(e){n({type:b,payload:e.response})}))}},addFriendToAuth:ce,declineFriendRequest:re,cancelFriendRequest:se})((function(e){var t=e.friends,n=e.deleteFriend,a=e.auth,c=e.user,r=e.deleteFriendFromAuth,s=e.addFriendToAuth,i=e.declineFriendRequest,o=e.cancelFriendRequest,l=Object.keys(t).map((function(e){return t[e]})),d=function(e){return a.user.friends[e.id]?[{label:"Unfriend",function:function(){var t,s;t=c.id,s=e.id,t===a.user.id?n(a.user,s):r(a.user,s)}}]:a.user.incomingFriendRequests[e.id]?[{label:"Accept friend request",function:function(){var t;t=e.id,s({friendId:t},a.user.username)}},{label:"Decline friend request",function:function(){var t;t=e.id,i(a.user.username,t)}}]:a.user.outgoingFriendRequests[e.id]?[{label:"Cancel friend request",function:function(){var t;t=e.id,o(a.user.username,t)}}]:[]};return Object(fe.jsxs)("section",{className:"profile-friends primary-frame primary-bg-color",children:[Object(fe.jsx)("header",{children:Object(fe.jsx)("h2",{children:"Friends"})}),l.length>0?Object(fe.jsx)("ul",{className:"profile-friends-list",children:l.map((function(e){return Object(fe.jsxs)("li",{className:"senary-frame",children:[Object(fe.jsxs)("div",{className:"friend-id-wrapper",children:[Object(fe.jsx)("a",{href:"/".concat(e.username),className:"link-wrapper",children:Object(fe.jsx)("img",{src:e.picture.url,alt:"user's profile avatar",className:"friend-picture"})}),Object(fe.jsx)("a",{href:"/".concat(e.username),children:Object(fe.jsx)("h3",{children:e.name})})]}),e.id!==a.user.id?a.user.friends[e.id]||a.user.incomingFriendRequests[e.id]||a.user.outgoingFriendRequests[e.id]?Object(fe.jsx)(ge,{items:d(e)}):Object(fe.jsx)(Pe,{shortVersion:!0,parent:e}):null]},e.id)}))}):Object(fe.jsx)("p",{className:"no-data-msg",children:"There is no one here."})]})}));n(143);var De=Object(o.b)((function(e){return{errors:e.errors}}))((function(e){var t,n=e.errors,c=Object(o.c)(),r=Object(a.useRef)(n);return Object(a.useEffect)((function(){c({type:p})}),[]),Object(fe.jsxs)("div",{className:"error",children:[Object(fe.jsx)("h1",{children:"An Error Has Occurred"}),Object(fe.jsx)("p",{children:null===(t=r.current)||void 0===t?void 0:t.message})]})}));var qe=Object(o.b)((function(e){return{posts:e.posts,auth:e.auth}}),{getPosts:ae,saveFriends:function(e){return function(t){t({type:H,payload:e})}},enableUploadPicture:function(){return function(e){e({type:Q})}}})((function(e){var t=e.match,n=e.getPosts,c=(e.posts,e.saveFriends),r=e.auth,s=e.enableUploadPicture,l=Object(o.c)(),d=Object(a.useState)({}),u=Object($.a)(d,2),j=u[0],p=u[1],h=Object(a.useRef)(!0);return Object(a.useEffect)((function(){z.a.get("/api/users/".concat(t.params.username)).then((function(e){h.current=!1,p(e.data.user),n(e.data.posts),c(e.data.user.friends)})).catch((function(e){h.current=!1,l({type:b,payload:e})}))}),[]),Object(fe.jsx)("div",{className:"profile",children:h.current?Object(fe.jsx)(fe.Fragment,{children:Object(fe.jsx)(le.a,{variant:"primary",animation:"border",role:"status",children:Object(fe.jsx)("span",{className:"visually-hidden",children:"Loading..."})})}):void 0!==j.name?Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsxs)("header",{className:"profile-header primary-bg-color quinary-frame",children:[Object(fe.jsxs)("div",{children:[j.username===r.user.username?Object(fe.jsxs)("button",{onClick:s,className:"profile-upload-btn",children:[Object(fe.jsx)("img",{src:j.picture.url,alt:"user's profile avatar",className:"user-picture"}),Object(fe.jsx)("div",{className:"profile-upload-icon",children:Object(fe.jsx)(oe.c,{})})]}):Object(fe.jsx)("img",{src:j.picture.url,alt:"user's profile avatar",className:"user-picture"}),Object(fe.jsx)("h1",{children:j.name})]}),Object(fe.jsxs)("div",{className:"profile-nav",children:[Object(fe.jsxs)("ul",{className:"navigation-links",children:[Object(fe.jsx)("li",{children:Object(fe.jsx)(ee.c,{exact:!0,to:"/".concat(j.username),activeClassName:"selected",className:"nav-link hovered-link light-bold",children:"Posts"})}),Object(fe.jsx)("li",{children:Object(fe.jsx)(ee.c,{exact:!0,to:"/".concat(j.username,"/friends"),activeClassName:"selected",className:"nav-link hovered-link light-bold",children:"Friends"})})]}),Object(fe.jsx)("div",{className:"friend-btn",children:Object(fe.jsx)(Pe,{parent:j})})]})]}),Object(fe.jsx)("main",{children:Object(fe.jsxs)(i.d,{children:[Object(fe.jsx)(i.b,{exact:!0,path:"/:username",render:function(){return Object(fe.jsx)(we,{user:j})}}),Object(fe.jsx)(i.b,{path:"/:username/friends",render:function(){return Object(fe.jsx)(Le,{user:j})}}),Object(fe.jsx)(i.b,{path:"/:username/*",component:De})]})})]}):null})})),Ue=n(10);n(147);var Me=Object(o.b)((function(e){return{auth:e.auth,errors:e.errors}}),{login:function(e){return function(t){z.a.post("/api/auth/login",e).then((function(e){t({type:p}),t({type:j,payload:e.data})})).catch((function(e){t({type:b,payload:e.response})}))}},enableSignupForm:function(){return function(e){e({type:p}),e({type:P})}}})(Object(i.g)((function(e){var t,n,c,r,s,i,o=e.auth,l=e.errors,d=e.login,u=e.history,j=e.enableSignupForm,b=Object(a.useState)(""),p=Object($.a)(b,2),h=p[0],m=p[1],f=Object(a.useState)(""),O=Object($.a)(f,2),x=O[0],v=O[1];Object(a.useEffect)((function(){o.isAuthenticated&&u.push("/")}),[]);var y=function(e){var t=e.target,n=t.name,a=t.value;"email"===n&&m(a),"password"===n&&v(a)};return Object(fe.jsxs)("div",{className:"login",children:[Object(fe.jsx)("h1",{className:"site-name primary-font-color",children:"odinbook"}),Object(fe.jsxs)("section",{className:"primary-frame primary-bg-color",children:[Object(fe.jsxs)(Ue.a,{onSubmit:function(e){e.preventDefault(),d({email:h,password:x})},className:"login-form",children:[Object(fe.jsxs)(Ue.a.Group,{children:[Object(fe.jsx)(Ue.a.Control,{type:"text",name:"email",placeholder:"Email",value:h,onChange:y,isInvalid:null===l||void 0===l||null===(t=l.data)||void 0===t?void 0:t.email}),Object(fe.jsx)(Ue.a.Control.Feedback,{type:"invalid",children:null===l||void 0===l||null===(n=l.data)||void 0===n||null===(c=n.email)||void 0===c?void 0:c.msg})]}),Object(fe.jsxs)(Ue.a.Group,{children:[Object(fe.jsx)(Ue.a.Control,{type:"text",name:"password",placeholder:"Password",value:x,onChange:y,isInvalid:null===l||void 0===l||null===(r=l.data)||void 0===r?void 0:r.password}),Object(fe.jsx)(Ue.a.Control.Feedback,{type:"invalid",children:null===l||void 0===l||null===(s=l.data)||void 0===s||null===(i=s.password)||void 0===i?void 0:i.msg})]}),Object(fe.jsx)("button",{className:"tertiary-bg-color tertiary-font-color validation-btn",type:"submit",children:"Log In"})]}),Object(fe.jsx)("button",{className:"tertiary-bg-color tertiary-font-color validation-btn guest-btn",onClick:function(){d({email:"guestuser@test.com",password:"guestuser"})},children:"Log In As Guest"}),Object(fe.jsx)("hr",{}),Object(fe.jsx)("div",{className:"signup-wrapper",children:Object(fe.jsx)(Te.a,{className:"signup-btn",variant:"success",onClick:j,children:"Create new account"})})]})]})})));n(148),n(149);var Be=Object(o.b)((function(e){return{friends:e.friends,action:e.action}}))((function(e){var t=e.friends,n=e.heading,c=e.getApiData,r=e.action,s=e.buttonItems,i=Object(o.c)(),d=Object(a.useState)([]),u=Object($.a)(d,2),j=u[0],b=u[1],p=Object(a.useRef)(!0),h=Object(a.useRef)(r);return Object(a.useEffect)((function(){c()}),[]),Object(a.useEffect)((function(){JSON.stringify(h.current)!==JSON.stringify(r)&&(p.current=!1,b(Object.keys(t).map((function(e){return t[e]}))),i({type:J}))}),[r]),Object(a.useEffect)((function(){b(Object.keys(t).map((function(e){return t[e]})))}),[t]),Object(fe.jsx)(fe.Fragment,{children:p.current?Object(fe.jsx)(le.a,{variant:"primary",animation:"border",role:"status",children:Object(fe.jsx)("span",{className:"visually-hidden",children:"Loading..."})}):Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)("h2",{children:n}),Object(fe.jsx)("ul",{className:"friends-list",children:j.length>0?j.map((function(e){return Object(fe.jsxs)("li",{className:"septenary-frame primary-bg-color",children:[Object(fe.jsx)("a",{href:"/".concat(e.username),className:"link-wrapper",children:Object(fe.jsx)("img",{src:e.picture.url,alt:"user's profile avatar"})}),Object(fe.jsxs)("div",{className:"bottom",children:[Object(fe.jsx)("a",{href:"/".concat(e.username),children:Object(fe.jsx)("h3",{className:"regular-bold",children:e.name})}),s.map((function(t){return Object(fe.jsx)(Te.a,Object(xe.a)(Object(xe.a)({},t.props),{},{onClick:function(){t.function(e.id)},className:"light-bold",children:t.label}),Object(l.a)())}))]})]},e.username)})):Object(fe.jsx)("p",{children:"There is no one here."})})]})})}));n(150);function Ge(e){var t=e.heading,n=e.mainItems,c=e.navItems,r=e.className,s=Object(a.useState)(!1),o=Object($.a)(s,2),d=o[0],u=o[1];return Object(fe.jsxs)("div",{className:"account-dashboard ".concat(r),children:[Object(fe.jsxs)("aside",{className:"quinary-frame primary-bg-color",children:[Object(fe.jsxs)("header",{children:[Object(fe.jsx)("h1",{children:t}),Object(fe.jsx)("div",{className:"sm-display toggle-btn",children:Object(fe.jsx)("button",{onClick:function(){u(!d)},className:"burger-btn".concat(d?" open":""),children:Object(fe.jsx)("div",{className:"burger-icon"})})})]}),Object(fe.jsx)("ul",{className:d?"show":void 0,children:c.map((function(e){return Object(fe.jsx)("li",{children:Object(fe.jsxs)(ee.c,Object(xe.a)(Object(xe.a)({exact:!0,to:e.path,activeClassName:"selected"},e.props),{},{children:[Object(fe.jsx)("i",{children:Object(fe.jsx)(e.icon,{})}),Object(fe.jsx)("h6",{children:e.heading})]}))},Object(l.a)())}))})]}),Object(fe.jsx)("main",{className:"primary-bg-color quinary-frame",children:Object(fe.jsxs)(i.d,{children:[n.map((function(e,t){return Object(fe.jsx)(i.b,{exact:0===t,path:e.path,render:function(t){return Object(fe.jsx)(e.component,Object(xe.a)(Object(xe.a)({},t),e.componentProps))}},t)})),Object(fe.jsx)(i.b,{path:"".concat(n[0].path,"/*"),component:De})]})})]})}var He={getFriends:function(e){return function(t){z.a.get("/api/users/".concat(e,"/friends")).then((function(e){t({type:H,payload:e.data}),t({type:W,payload:{type:H,payload:e.data}})})).catch((function(e){t({type:b,payload:e.response})}))}},getIncomingFriendRequests:function(e){return function(t){z.a.get("/api/users/".concat(e,"/requests?received=true")).then((function(e){t({type:H,payload:e.data.friendRequestsReceived}),t({type:W,payload:{type:H,payload:e.data}})})).catch((function(e){t({type:b,payload:e.response})}))}},deleteFriend:ie,addFriendToAuth:ce,declineFriendRequest:re},We=Object(o.b)((function(e){return{auth:e.auth,errors:e.errors,action:e.action}}),He)((function(e){var t=e.auth,n=e.getFriends,a=e.getIncomingFriendRequests,c=e.deleteFriend,r=e.addFriendToAuth,s=e.declineFriendRequest,i=(e.errors,Object(o.c)()),l=[{path:"/friends",props:{className:"dashboard-link sidebar-link hovered-link"},icon:Fe.b,heading:"All Friends"},{path:"/friends/requests",props:{className:"dashboard-link sidebar-link hovered-link"},icon:oe.d,heading:"Friend Requests"}],d=[{path:"/friends",component:Be,componentProps:{heading:"All Friends",getApiData:function(){n(t.user.username)},buttonItems:[{label:"Unfriend",function:function(e){c(t.user,e)}}]}},{path:"/friends/requests",component:Be,componentProps:{heading:"Friend Requests",getApiData:function(){a(t.user.username)},buttonItems:[{label:"Accept",function:function(e){r({friendId:e},t.user.username),i({type:M,payload:{userId:t.user.id,friendId:e}})}},{label:"Decline",function:function(e){s(t.user.username,e),i({type:M,payload:{userId:t.user.id,friendId:e}})},props:{className:"secondary-bg-color"}}]}}];return Object(fe.jsx)(Ge,{heading:"Friends",navItems:l,mainItems:d,className:"friends-dashboard"})})),Je=(n(151),n(152),n(48));var Ve=Object(o.b)((function(e){return{auth:e.auth}}))((function(e){var t=e.auth;return Object(fe.jsx)("aside",{className:"home-sidebar",children:Object(fe.jsxs)("ul",{children:[Object(fe.jsx)("li",{children:Object(fe.jsxs)(ee.b,{to:"/".concat(t.user.username),className:"hovered-link secondary-bg-color-hover sidebar-link",children:[Object(fe.jsx)("img",{src:t.user.picture.url,alt:"user's profile avatar",className:"user-picture"}),Object(fe.jsx)("h6",{children:t.user.name})]})}),Object(fe.jsx)("li",{children:Object(fe.jsxs)(ee.b,{to:"/friends",className:"hovered-link secondary-bg-color-hover sidebar-link",children:[Object(fe.jsx)("i",{className:"primary-font-color",children:Object(fe.jsx)(Je.d,{})}),Object(fe.jsx)("h6",{children:"Friends"})]})})]})})}));var Qe=Object(o.b)((function(e){return{auth:e.auth,posts:e.posts}}),{getPosts:ae})((function(e){e.auth;var t=e.getPosts,n=e.posts,c=Object(o.c)(),r=Object(a.useRef)(!0);return Object(a.useEffect)((function(){z.a.get("/api/posts?recent=true").then((function(e){r.current=!1,t(e.data)})).catch((function(e){r.current=!1,c({type:b,payload:e})}))}),[]),Object(fe.jsxs)("div",{className:"newsfeed",children:[Object(fe.jsx)(Ve,{}),Object(fe.jsxs)("main",{children:[Object(fe.jsx)(Ie,{}),r.current?Object(fe.jsx)(le.a,{variant:"primary",animation:"border",role:"status",children:Object(fe.jsx)("span",{className:"visually-hidden",children:"Loading..."})}):n.length>0?Object(fe.jsx)(Se,{posts:n}):Object(fe.jsx)("p",{className:"no-data-msg",children:"It looks like no one has posted anything yet."})]}),Object(fe.jsx)("div",{className:"invisible"})]})})),Ke=(n(153),n(93));var Ye=Object(o.b)((function(e){return{auth:e.auth}}),{logout:function(e){return function(t){z.a.get("/api/auth/logout").then((function(n){t({type:u}),t({type:w}),t({type:I}),t({type:L}),t({type:_}),t({type:A}),e.push("/")})).catch((function(e){t({type:b,payload:e.response})}))}}})(Object(i.g)((function(e){var t=e.logout,n=e.history,c=e.auth,r=Object(o.c)(),s=Object(a.useState)([]),i=Object($.a)(s,2),l=i[0],d=i[1],u=Object(a.useRef)(!1),j=Object(a.useRef)();return Object(fe.jsxs)("nav",{className:"nav-bar primary-bg-color quinary-frame",children:[Object(fe.jsxs)("div",{className:"search",children:[Object(fe.jsxs)(ee.b,{to:"/",children:[Object(fe.jsx)("i",{className:"site-icon primary-font-color reg-display",children:"Odinbook"}),Object(fe.jsx)("i",{className:"site-icon tertiary-font-color tertiary-bg-color sm-display",children:"0"})]}),Object(fe.jsxs)(ye.a,{className:"search-btn",children:[Object(fe.jsx)(ye.a.Toggle,{children:Object(fe.jsx)("i",{className:"secondary-bg-color search-icon secondary-font-color",onClick:function(){setTimeout((function(){j.current.focus()}),250)},children:Object(fe.jsx)(Ke.a,{})})}),Object(fe.jsxs)(ye.a.Menu,{children:[Object(fe.jsxs)("div",{className:"top",children:[Object(fe.jsx)("button",{className:"return-btn secondary-font-color secondary-bg-color-hover",onClick:function(){document.querySelector("body").click()},children:Object(fe.jsx)("i",{children:Object(fe.jsx)(oe.a,{})})}),Object(fe.jsx)("input",{onChange:function(e){""!==e.target.value?(u.current=!0,z.a.get("/api/users?name=".concat(e.target.value)).then((function(e){u.current=!1,d(e.data.slice(0,8))})).catch((function(e){u.current=!1,r({type:b,payload:e.response})}))):d([])},type:"text",placeholder:"Search Odinbook",className:"secondary-bg-color secondary-frame",ref:j})]}),Object(fe.jsx)("ul",{children:u.current?Object(fe.jsx)(le.a,{variant:"primary",animation:"border",role:"status",children:Object(fe.jsx)("span",{className:"visually-hidden",children:"Loading..."})}):l.map((function(e){return Object(fe.jsx)("li",{children:Object(fe.jsxs)(ye.a.Item,{href:"/".concat(e.username),children:[Object(fe.jsx)("img",{src:e.picture.url,alt:"user's profile avatar",className:"user-picture"}),Object(fe.jsx)("h6",{children:e.name})]})},e.id)}))})]})]})]}),Object(fe.jsxs)("ul",{className:"navigation-links",children:[Object(fe.jsx)("li",{children:Object(fe.jsxs)(ee.c,{exact:!0,to:"/",activeClassName:"selected",className:"nav-link hovered-link",children:[Object(fe.jsx)("i",{className:"icon outline",children:Object(fe.jsx)(Je.a,{})}),Object(fe.jsx)("i",{className:"icon filled",children:Object(fe.jsx)(Je.b,{})})]})}),Object(fe.jsx)("li",{children:Object(fe.jsxs)(ee.c,{to:"/friends",activeClassName:"selected",className:"nav-link hovered-link",children:[Object(fe.jsx)("i",{className:"icon outline",children:Object(fe.jsx)(Je.e,{})}),Object(fe.jsx)("i",{className:"icon filled",children:Object(fe.jsx)(Je.f,{})})]})})]}),Object(fe.jsx)("div",{className:"navigation-buttons",children:Object(fe.jsxs)(ye.a,{children:[Object(fe.jsx)(ye.a.Toggle,{variant:"secondary"}),Object(fe.jsx)(ye.a.Menu,{variant:"light",children:Object(fe.jsxs)("ul",{children:[Object(fe.jsxs)("li",{children:[Object(fe.jsxs)(ye.a.Item,{href:"/".concat(c.user.username),className:"top-link hovered-link",children:[Object(fe.jsx)("img",{src:c.user.picture.url,alt:"user's profile avatar",className:"user-picture"}),Object(fe.jsxs)("div",{children:[Object(fe.jsx)("h2",{children:c.user.name}),Object(fe.jsx)("p",{className:"secondary-font-color",children:"See your profile"})]})]}),Object(fe.jsx)("hr",{className:"secondary-font-color"})]}),"guestuser"!==c.user.username&&Object(fe.jsx)("li",{children:Object(fe.jsxs)(ye.a.Item,{href:"/settings",className:"dropdown-btn hovered-link",children:[Object(fe.jsx)("i",{children:Object(fe.jsx)(pe.a,{})}),Object(fe.jsx)("h6",{children:"Settings"})]})}),Object(fe.jsx)("li",{children:Object(fe.jsxs)(ye.a.Item,{onClick:function(){t(n)},className:"dropdown-btn hovered-link",children:[Object(fe.jsx)("i",{children:Object(fe.jsx)(Je.c,{})}),Object(fe.jsx)("h6",{children:"Log out"})]})})]})})]})})]})}))),ze=["component","auth"];var Xe=Object(o.b)((function(e){return{auth:e.auth}}))((function(e){var t=e.component,n=e.auth,a=Object(te.a)(e,ze);return Object(fe.jsx)(i.b,Object(xe.a)(Object(xe.a)({},a),{},{render:function(e){return n.isAuthenticated?Object(fe.jsx)(t,Object(xe.a)({},e)):Object(fe.jsx)(i.a,{to:"/"})}}))})),Ze=(n(154),["postForm"]);var $e=Object(o.b)((function(e){return{auth:e.auth,overlays:e.overlays,action:e.action}}),{updatePost:function(e){return function(t){z.a.put("/api/posts/".concat(e.id),{content:e.content}).then((function(e){wt.emit("update post",e.data),t({type:C,payload:e.data}),t({type:W,payload:{type:C,payload:e.data}})})).catch((function(e){t({type:b,payload:e.response})}))}},addPost:function(e){return function(t){z.a.post("/api/posts",e).then((function(e){wt.emit("new post",e.data),t({type:O,payload:e.data}),t({type:R,payload:e.data}),t({type:W,payload:{type:R,payload:e.data}})})).catch((function(e){t({type:b,payload:e.response})}))}},disablePostForm:Z})((function(e){var t,n=e.updatePost,c=e.auth,r=e.addPost,s=e.disablePostForm,i=e.overlays,l=i.postForm,u=(Object(te.a)(i,Ze),e.action),j=Object(a.useState)((null===l||void 0===l||null===(t=l.post)||void 0===t?void 0:t.content)||""),b=Object($.a)(j,2),p=b[0],h=b[1],m=Object(a.useRef)(),f=Object(o.c)(),O=Object(a.useRef)(u);return Object(a.useEffect)((function(){m.current.disabled=""===p}),[p]),Object(a.useEffect)((function(){JSON.stringify(O.current)!==JSON.stringify(u)&&(s(),f({type:J}))}),[u]),Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)(d.a.Header,{closeButton:!0,children:Object(fe.jsx)(d.a.Title,{as:"h2",children:"".concat(l.post?"Edit":"Create"," Post")})}),Object(fe.jsxs)(d.a.Body,{as:"form",onSubmit:function(e){if(e.preventDefault(),l.post){var t=Object(xe.a)({},l.post);t.content=p,n(t)}else{var a={profileId:l.profile.id,content:p};r(a)}},className:"post-form",children:[Object(fe.jsxs)("div",{className:"user",children:[Object(fe.jsx)("a",{href:"/".concat(c.user.username),rel:"author",className:"left",children:Object(fe.jsx)("img",{src:c.user.picture.url,alt:"user's profile avatar",className:"user-picture"})}),Object(fe.jsx)("h3",{children:c.user.name})]}),Object(fe.jsx)("textarea",{type:"text",placeholder:l.profile.id===c.user.id?"What's on your mind?":"Write something to ".concat(l.profile.first_name,"..."),value:de(p),onChange:function(e){h(e.target.value)},required:!0}),Object(fe.jsx)("button",{ref:m,type:"submit",className:"tertiary-bg-color tertiary-font-color validation-btn",disabled:!0,children:l.post?"Save":"Post"})]})]})}));n(155);var et=Object(o.b)((function(e){return{overlays:e.overlays}}))((function(e){var t=e.overlays;return Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)(d.a.Header,{closeButton:!0,children:Object(fe.jsx)(d.a.Title,{as:"h2",children:"Likes"})}),Object(fe.jsx)(d.a.Body,{as:"ul",className:"reactions-list",children:t.reactionsList.reactions.map((function(e){return Object(fe.jsx)("li",{children:Object(fe.jsxs)("div",{className:"user",children:[Object(fe.jsx)("a",{href:"/".concat(e.author.username),children:Object(fe.jsx)("img",{src:e.author.picture.url,alt:"user's profile avatar",className:"user-picture"})}),Object(fe.jsx)("a",{href:"/".concat(e.author.username),children:Object(fe.jsx)("h3",{children:e.author.name})})]})},e._id)}))})]})}));n(156);var tt={register:function(e,t){return function(n){z.a.post("/api/auth/register",e).then((function(e){n({type:p}),n({type:L}),t.push("/")})).catch((function(e){n({type:b,payload:e.response})}))}}},nt=Object(o.b)((function(e){return{auth:e.auth,errors:e.errors}}),tt)(Object(i.g)((function(e){var t,n,c,r,s,i,o,l,u,j,b,p,h,m,f,O=e.auth,x=e.errors,v=e.register,y=e.history,g=Object(a.useState)(""),N=Object($.a)(g,2),E=N[0],F=N[1],C=Object(a.useState)(""),k=Object($.a)(C,2),_=k[0],R=k[1],S=Object(a.useState)(""),I=Object($.a)(S,2),w=I[0],T=I[1],A=Object(a.useState)(""),P=Object($.a)(A,2),L=P[0],D=P[1],q=Object(a.useState)(""),U=Object($.a)(q,2),M=U[0],B=U[1];Object(a.useEffect)((function(){O.isAuthenticated&&y.push("/")}),[]);var G=function(e){var t=e.target,n=t.name,a=t.value;switch(n){case"username":F(a);break;case"password":R(a);break;case"email":T(a);break;case"first-name":D(a);break;case"last-name":B(a);break;default:return}};return Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)(d.a.Header,{closeButton:!0,children:Object(fe.jsxs)("div",{children:[Object(fe.jsx)(d.a.Title,{as:"h2",children:"Sign Up"}),Object(fe.jsx)("p",{children:"It's quick and easy."})]})}),Object(fe.jsxs)(d.a.Body,{as:"form",onSubmit:function(e){e.preventDefault(),v({username:E,password:_,email:w,firstName:L,lastName:M},y)},className:"signup-form",children:[Object(fe.jsxs)(Ue.a.Group,{children:[Object(fe.jsx)(Ue.a.Control,{type:"text",name:"first-name",placeholder:"First name",value:L,onChange:G,isInvalid:null===x||void 0===x||null===(t=x.data)||void 0===t?void 0:t.firstName}),Object(fe.jsx)(Ue.a.Control.Feedback,{type:"invalid",children:null===x||void 0===x||null===(n=x.data)||void 0===n||null===(c=n.firstName)||void 0===c?void 0:c.msg})]}),Object(fe.jsxs)(Ue.a.Group,{children:[Object(fe.jsx)(Ue.a.Control,{type:"text",name:"last-name",placeholder:"Last name",value:M,onChange:G,isInvalid:null===x||void 0===x||null===(r=x.data)||void 0===r?void 0:r.lastName}),Object(fe.jsx)(Ue.a.Control.Feedback,{type:"invalid",children:null===x||void 0===x||null===(s=x.data)||void 0===s||null===(i=s.lastName)||void 0===i?void 0:i.msg})]}),Object(fe.jsxs)(Ue.a.Group,{children:[Object(fe.jsx)(Ue.a.Control,{type:"text",name:"username",placeholder:"Username",value:E,onChange:G,isInvalid:null===x||void 0===x||null===(o=x.data)||void 0===o?void 0:o.username}),Object(fe.jsx)(Ue.a.Control.Feedback,{type:"invalid",children:null===x||void 0===x||null===(l=x.data)||void 0===l||null===(u=l.username)||void 0===u?void 0:u.msg})]}),Object(fe.jsxs)(Ue.a.Group,{children:[Object(fe.jsx)(Ue.a.Control,{type:"text",name:"email",placeholder:"Email",value:w,onChange:G,isInvalid:null===x||void 0===x||null===(j=x.data)||void 0===j?void 0:j.email}),Object(fe.jsx)(Ue.a.Control.Feedback,{type:"invalid",children:null===x||void 0===x||null===(b=x.data)||void 0===b||null===(p=b.email)||void 0===p?void 0:p.msg})]}),Object(fe.jsxs)(Ue.a.Group,{children:[Object(fe.jsx)(Ue.a.Control,{type:"text",name:"password",placeholder:"Password",value:_,onChange:G,isInvalid:null===x||void 0===x||null===(h=x.data)||void 0===h?void 0:h.password}),Object(fe.jsx)(Ue.a.Control.Feedback,{type:"invalid",children:null===x||void 0===x||null===(m=x.data)||void 0===m||null===(f=m.password)||void 0===f?void 0:f.msg})]}),Object(fe.jsx)(Te.a,{className:"signup-btn",variant:"success",type:"submit",children:"Sign Up"})]})]})}))),at=(n(157),n(11));n(158);var ct={deleteAccount:function(e,t){return function(n){z.a.delete("/api/users/".concat(e)).then((function(e){n({type:u}),n({type:w}),n({type:I}),t.push("/")})).catch((function(e){n({type:b,payload:e.response})}))}}},rt=Object(o.b)((function(e){return{auth:e.auth}}),ct)(Object(i.g)((function(e){var t=e.heading,n=e.content,c=e.btnLabel,r=e.deleteAccount,s=e.auth,i=e.history,l=Object(a.useState)(!1),d=Object($.a)(l,2),u=d[0],j=d[1],b=Object(a.useState)({}),p=Object($.a)(b,2),h=p[0],m=p[1],f=Object(a.useState)({}),O=Object($.a)(f,2),x=O[0],v=O[1],y=Object(o.c)();Object(a.useEffect)((function(){switch(t){case"Name":m(n);break;case"Email address":m({email:n});break;case"Password":m({password:n});break;default:return}return function(){v({})}}),[]);var g=function(e){m(Object(xe.a)(Object(xe.a)({},h),{},Object(at.a)({},e.target.name,e.target.value)))},N=function(){j(!u)},E=function(e){e.preventDefault(),z.a.put("/api/users/".concat(s.user.username),h).then((function(e){y({type:V,payload:e.data}),N()})).catch((function(e){v(e.response)}))};return Object(fe.jsx)("li",{className:"account-info-item",children:u?Object(fe.jsxs)("form",{className:"sub-wrapper secondary-bg-color",children:[Object(fe.jsx)("h3",{children:t}),Object(fe.jsx)(Ue.a.Group,{className:"content ".concat("Account management"===t?"account-management":""),children:function(){var e,n,a,c,o,l,d,u,j,b,p,m;switch(t){case"Name":return Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsxs)("label",{className:"secondary-font-color light-bold",children:[Object(fe.jsx)("span",{children:"First"}),Object(fe.jsx)(Ue.a.Control,{type:"text",placeholder:"First name",name:"firstName",value:h.firstName,onChange:g,isInvalid:null===x||void 0===x||null===(e=x.data)||void 0===e?void 0:e.firstName}),Object(fe.jsx)(Ue.a.Control.Feedback,{type:"invalid",children:null===x||void 0===x||null===(n=x.data)||void 0===n||null===(a=n.firstName)||void 0===a?void 0:a.msg})]}),Object(fe.jsxs)("label",{className:"secondary-font-color light-bold",children:[Object(fe.jsx)("span",{children:"Last"}),Object(fe.jsx)(Ue.a.Control,{type:"text",placeholder:"Last name",name:"lastName",value:h.lastName,onChange:g,isInvalid:null===x||void 0===x||null===(c=x.data)||void 0===c?void 0:c.lastName}),Object(fe.jsx)(Ue.a.Control.Feedback,{type:"invalid",children:null===x||void 0===x||null===(o=x.data)||void 0===o||null===(l=o.lastName)||void 0===l?void 0:l.msg})]}),Object(fe.jsxs)("div",{className:"validation",children:[Object(fe.jsx)(Te.a,{onClick:E,children:"Submit"}),Object(fe.jsx)(Te.a,{variant:"secondary",onClick:N,children:"Cancel"})]})]});case"Email address":return Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)(Ue.a.Control,{type:"email",placeholder:"Email address",name:"email",value:h.email,onChange:g,isInvalid:null===x||void 0===x||null===(d=x.data)||void 0===d?void 0:d.email}),Object(fe.jsx)(Ue.a.Control.Feedback,{type:"invalid",children:null===x||void 0===x||null===(u=x.data)||void 0===u||null===(j=u.email)||void 0===j?void 0:j.msg}),Object(fe.jsxs)("div",{className:"validation",children:[Object(fe.jsx)(Te.a,{onClick:E,children:"Submit"}),Object(fe.jsx)(Te.a,{variant:"secondary",onClick:N,children:"Cancel"})]})]});case"Password":return Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)(Ue.a.Control,{type:"text",placeholder:"Password",name:"password",value:h.password,onChange:g,isInvalid:null===x||void 0===x||null===(b=x.data)||void 0===b?void 0:b.password}),Object(fe.jsx)(Ue.a.Control.Feedback,{type:"invalid",children:null===x||void 0===x||null===(p=x.data)||void 0===p||null===(m=p.password)||void 0===m?void 0:m.msg}),Object(fe.jsxs)("div",{className:"validation",children:[Object(fe.jsx)(Te.a,{onClick:E,children:"Submit"}),Object(fe.jsx)(Te.a,{variant:"secondary",onClick:N,children:"Cancel"})]})]});case"Account management":return Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)("p",{children:"Are you sure you want to delete your account?"}),Object(fe.jsxs)("div",{className:"validation",children:[Object(fe.jsx)(Te.a,{variant:"danger",onClick:function(){r(s.user.username,i)},children:"Delete my account"}),Object(fe.jsx)(Te.a,{variant:"secondary",onClick:N,children:"Cancel"})]})]});default:return Object(fe.jsx)(fe.Fragment,{})}}()})]}):Object(fe.jsxs)("div",{className:"info-display sub-wrapper hovered-link",onClick:N,children:[Object(fe.jsx)("h3",{children:t}),Object(fe.jsx)("p",{className:"content",children:h[Object.keys(h)[0]]||""}),Object(fe.jsx)("button",{className:"primary-font-color expand-btn",children:c})]})})})));var st=Object(o.b)((function(e){return{auth:e.auth}}))((function(e){var t=e.heading,n=e.auth,c=Object(o.c)(),r=Object(a.useState)([]),s=Object($.a)(r,2),i=s[0],d=s[1];return Object(a.useEffect)((function(){z.a.get("/api/users/".concat(n.user.username,"?accountInfo=true")).then((function(e){d([{heading:"Name",content:{name:e.data.name,firstName:e.data.first_name,lastName:e.data.last_name},btnLabel:"Edit"},{heading:"Email address",content:e.data.email,btnLabel:"Edit"},{heading:"Password",content:"",btnLabel:"Update"},{heading:"Account management",btnLabel:"View"}])})).catch((function(e){c({type:b,payload:e.response})}))}),[]),Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)("h2",{children:t}),Object(fe.jsx)("ul",{className:"account-info-list",children:i.map((function(e){return Object(fe.jsx)(rt,{heading:e.heading,content:e.content,btnLabel:e.btnLabel},Object(l.a)())}))})]})})),it=n(94);function ot(){var e=[{path:"/settings",props:{className:"dashboard-link sidebar-link hovered-link"},icon:it.a,heading:"General"}],t=[{path:"/settings",component:st,componentProps:{heading:"General Account Settings"}}];return Object(fe.jsx)(Ge,{className:"settings-dashboard",navItems:e,mainItems:t,heading:"Settings"})}var lt=n(77),dt=n.n(lt),ut=n(95),jt=n(96),bt=n.n(jt);function pt(e,t){var n=document.createElement("canvas"),a=e.naturalWidth/e.width,c=e.naturalHeight/e.height;n.width=t.width,n.height=t.height;var r=n.getContext("2d"),s=window.devicePixelRatio;return n.width=t.width*s,n.height=t.height*s,r.setTransform(s,0,0,s,0,0),r.imageSmoothingQuality="high",r.drawImage(e,t.x*a,t.y*c,t.width*a,t.height*c,0,0,t.width,t.height),new Promise((function(e,t){n.toBlob((function(t){e(t)}),"image/jpeg",1)}))}n(171),n(172);var ht=Object(o.b)((function(e){return{auth:e.auth}}))((function(e){var t=e.auth,n=Object(o.c)(),c=Object(a.useState)(!1),r=Object($.a)(c,2),s=r[0],i=r[1],l=Object(a.useState)(null),u=Object($.a)(l,2),j=u[0],p=u[1],h=Object(a.useState)(null),m=Object($.a)(h,2),f=m[0],O=m[1],x=Object(a.useState)({aspect:1}),v=Object($.a)(x,2),y=v[0],g=v[1],N=function(){i(!s)},E=function(){var e=Object(ut.a)(dt.a.mark((function e(a){var c,r,s;return dt.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pt(f,y);case 2:c=e.sent,(r=new FormData).append("image",c),s={header:{"Content-Type":"multipart/form-data"}},z.a.put("/api/users/".concat(t.user.username,"/profile-picture"),r,s).then((function(e){window.location.reload(!0)})).catch((function(e){n({type:b,payload:e})}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(fe.jsxs)(fe.Fragment,{children:[Object(fe.jsx)(d.a.Header,{closeButton:!0,children:Object(fe.jsx)(d.a.Title,{as:"h2",children:"Upload Profile Picture"})}),Object(fe.jsx)(d.a.Body,{as:"form",encType:"multipart/form-data",className:"upload-form",children:s?Object(fe.jsx)(bt.a,{src:j,onImageLoaded:O,crop:y,onChange:g,minHeight:"100",minWidth:"100"}):Object(fe.jsx)("div",{className:"form-input-wrapper",children:Object(fe.jsx)(Ue.a.Control,{type:"file",accept:"image/*",onChange:function(e){p(URL.createObjectURL(e.target.files[0])),N()}})})}),s&&Object(fe.jsxs)(d.a.Footer,{children:[Object(fe.jsx)(Te.a,{onClick:N,variant:"outline-primary",children:"Cancel"}),Object(fe.jsx)(Te.a,{onClick:E,children:"Save"})]})]})}));var mt=Object(o.b)((function(e){return{auth:e.auth,errors:e.errors,overlays:e.overlays}}),{verifyAuth:function(){return function(e){z.a.get("/api/auth/verify").then((function(t){e({type:j,payload:t.data})})).catch((function(t){e({type:b,payload:t.response})}))}},disablePostForm:Z,disableReactionsList:function(){return function(e){e({type:A})}},disableSignupForm:function(){return function(e){e({type:p}),e({type:L})}},disableUploadPicture:function(){return function(e){e({type:K})}}})(Object(i.g)((function(e){var t=e.auth,n=e.verifyAuth,c=e.errors,r=e.overlays,s=e.disablePostForm,o=e.disableReactionsList,u=e.disableSignupForm,j=e.disableUploadPicture,b=e.history;Object(a.useEffect)((function(){var e;(null===c||void 0===c||null===(e=c.response)||void 0===e?void 0:e.status)>=400&&b.push("/error")}),[c]),Object(a.useEffect)((function(){n()}),[]);var p=r.postForm,h=r.reactionsList,m=r.signupForm,f=r.uploadPicture;return Object(fe.jsxs)("div",{className:"App",children:[Object(fe.jsxs)(d.a,{show:function(){for(var e=0,t=Object.keys(r);e<t.length;e++){var n=t[e];if(r[n].isEnabled)return!0}return!1}(),onHide:function(){p.isEnabled&&s(),h.isEnabled&&o(),m.isEnabled&&u(),f.isEnabled&&j()},backdropClassName:"overlay-bg",dialogClassName:"quaternary-frame ".concat(f.isEnabled?"upload-picture":""),children:[p.isEnabled&&Object(fe.jsx)($e,{}),h.isEnabled&&Object(fe.jsx)(et,{}),m.isEnabled&&Object(fe.jsx)(nt,{}),f.isEnabled&&Object(fe.jsx)(ht,{})]}),t.isAuthenticated&&Object(fe.jsx)(Ye,{}),Object(fe.jsx)(i.b,{exact:!0,path:"/error",component:De}),t.isAuthenticated?Object(fe.jsxs)(i.d,{children:[Object(fe.jsx)(i.b,{exact:!0,path:"/",render:function(){return Object(fe.jsx)(Qe,{},Object(l.a)())}}),Object(fe.jsx)(Xe,{path:"/friends",component:We}),Object(fe.jsx)(Xe,{path:"/settings",component:ot}),Object(fe.jsx)(Xe,{path:"/:username",component:qe})]}):Object(fe.jsx)(i.b,{exact:!0,path:"/",component:Me})]})}))),ft=n(101),Ot=(n(177),n(178),n(59)),xt=n(100);function vt(e){return e.reduce((function(e,t){return t.id?e[t.id]=t:e[t]=t,e}),{})}var yt={isAuthenticated:!1,user:{}},gt={},Nt=n(44),Et=[],Ft={},Ct={postForm:{isEnabled:!1,profile:{}},reactionsList:{isEnabled:!1,reactions:[]},signupForm:{isEnabled:!1},uploadPicture:{isEnabled:!1}},kt={},_t={type:"",payload:null},Rt=Object(Ot.b)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case j:var c=Object(xe.a)({},a);return c.incomingFriendRequests=vt(c.incomingFriendRequests),c.outgoingFriendRequests=vt(c.outgoingFriendRequests),c.friends=vt(c.friends),Object(xe.a)(Object(xe.a)({},e),{},{isAuthenticated:!!a.username,user:c});case u:return Object(xe.a)(Object(xe.a)({},e),{},{isAuthenticated:!1,user:{}});case D:var r={};return r[a.id]=a,Object(xe.a)(Object(xe.a)({},e),{},{user:Object(xe.a)(Object(xe.a)({},e.user),{},{outgoingFriendRequests:Object(xe.a)(Object(xe.a)({},e.user.outgoingFriendRequests),r)})});case U:var s=Object(xe.a)({},e.user.outgoingFriendRequests);delete s[a];var i=Object(xe.a)({},e.user.incomingFriendRequests);return delete i[a],Object(xe.a)(Object(xe.a)({},e),{},{user:Object(xe.a)(Object(xe.a)({},e.user),{},{outgoingFriendRequests:s,incomingFriendRequests:i})});case B:return Object(xe.a)(Object(xe.a)({},e),{},{user:Object(xe.a)(Object(xe.a)({},e.user),{},{friends:Object(xe.a)(Object(xe.a)({},e.user.friends),{},Object(at.a)({},a.id,a))})});case G:var o=Object(xe.a)({},e.user.friends);return delete o[a],Object(xe.a)(Object(xe.a)({},e),{},{user:Object(xe.a)(Object(xe.a)({},e.user),{},{friends:o})});case V:var l=a.name,d=a.picture;return Object(xe.a)(Object(xe.a)({},e),{},{user:Object(xe.a)(Object(xe.a)({},e.user),{},{name:l,picture:d})});default:return e}},errors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gt,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case b:return t.payload;case p:return{};default:return e}},posts:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Et,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case f:return a;case N:return e.reduce((function(e,t){return t.id===a.post.id&&t.reactions.push(a.reaction),e.push(t),e}),[]);case E:return e.reduce((function(e,t){return t.id===a.post.id&&(t.reactions=t.reactions.filter((function(e){return e._id!==a.reaction._id}))),e.push(t),e}),[]);case F:return e.reduce((function(e,t){return t.id!==a.id&&e.push(t),e}),[]);case C:return e.reduce((function(e,t){return t.id===a.id&&(t.content=a.content),e.push(t),e}),[]);case O:return[a].concat(Object(Nt.a)(e));case w:return[];default:return e}},comments:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ft,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case h:return a;case m:var c=Object(Nt.a)(e[a[0].post_id]);return a.map((function(e){if(e.post_id!==e.parent_id){var t,n=Object(me.a)(c);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(a.id===e.parent_id){var r=a.replies.findIndex((function(t){return t.id===e.id}));if(r>-1){a.replies[r]=e;for(var s=0;s<c.length;s++)if(c[s].id===e.id){c.splice(s,1);break}}else a.replies.push(e);break}}}catch(i){n.e(i)}finally{n.f()}}c.push(e)})),Object(xe.a)(Object(xe.a)({},e),{},Object(at.a)({},c[0].post_id,c));case x:var r=a;return r.post_id!==r.parent_id?Object(xe.a)(Object(xe.a)({},e),{},Object(at.a)({},r.post_id,e[r.post_id].reduce((function(e,t){return t.id!==r.id&&e.push(t),t.id===r.parent_id&&(t.replies=t.replies.filter((function(e){return e.id!==r.id}))),e}),[]))):Object(xe.a)(Object(xe.a)({},e),{},Object(at.a)({},r.post_id,e[r.post_id].filter((function(e){return e.id!==r.id}))));case v:var s=a;return Object(xe.a)(Object(xe.a)({},e),{},Object(at.a)({},s.post_id,e[s.post_id].map((function(e){return e.id===s.id&&(e.content=s.content),e}))));case y:var i=a.comment,o=a.reaction;return Object(xe.a)(Object(xe.a)({},e),{},Object(at.a)({},i.post_id,e[i.post_id].map((function(e){return e.id===i.id&&e.reactions.push(o),e}))));case g:return Object(xe.a)(Object(xe.a)({},e),{},Object(at.a)({},a.comment.post_id,e[a.comment.post_id].map((function(e){return e.id===a.comment.id&&(e.reactions=e.reactions.filter((function(e){return e._id!==a.reaction._id}))),e}))));case R:return Object(xe.a)(Object(xe.a)({},e),{},Object(at.a)({},a.id,[]));case S:var l=Object(xe.a)({},e);return delete l[a.id],l;case I:return{};default:return e}},overlays:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ct,n=arguments.length>1?arguments[1]:void 0,a=n.type,c=n.payload;switch(a){case k:return(null===c||void 0===c||null===(e=c.post)||void 0===e?void 0:e.id)?Object(xe.a)(Object(xe.a)({},t),{},{postForm:{isEnabled:!0,post:c.post,profile:c.post.destination_profile}}):Object(xe.a)(Object(xe.a)({},t),{},{postForm:{isEnabled:!0,profile:c.profile}});case _:return Object(xe.a)(Object(xe.a)({},t),{},{postForm:{isEnabled:!1,profile:{}}});case T:return Object(xe.a)(Object(xe.a)({},t),{},{reactionsList:{isEnabled:!0,reactions:c}});case A:return Object(xe.a)(Object(xe.a)({},t),{},{reactionsList:{isEnabled:!1,reactions:[]}});case P:return Object(xe.a)(Object(xe.a)({},t),{},{signupForm:{isEnabled:!0}});case L:return Object(xe.a)(Object(xe.a)({},t),{},{signupForm:{isEnabled:!1}});case Q:return Object(xe.a)(Object(xe.a)({},t),{},{uploadPicture:{isEnabled:!0}});case K:return Object(xe.a)(Object(xe.a)({},t),{},{uploadPicture:{isEnabled:!1}});default:return t}},friends:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:kt,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case H:var c=vt(a);return c;case q:var r={};return r[a.id]=a,Object(xe.a)(Object(xe.a)({},e),r);case M:var s=Object(xe.a)({},e);return delete s[a.userId],delete s[a.friendId],s;default:return e}},action:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:_t,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case W:return a;case J:return{type:"",payload:null};default:return e}}}),St=[xt.a],It=Object(Ot.d)(Rt,{},Object(Ot.c)(Ot.a.apply(void 0,St))),wt=Object(ft.a)(),Tt=It.dispatch;wt.on("new post",(function(e){Tt({type:O,payload:e}),Tt({type:R,payload:e})})),wt.on("update post",(function(e){Tt({type:C,payload:e})})),wt.on("delete post",(function(e){Tt({type:F,payload:e}),Tt({type:S,payload:e})})),wt.on("new comment",(function(e){Tt({type:m,payload:[e]})})),wt.on("update comment",(function(e){Tt({type:v,payload:e})})),wt.on("delete comment",(function(e){Tt({type:x,payload:e})})),wt.on("new reaction",(function(e){e.comment?Tt({type:y,payload:e}):Tt({type:N,payload:e})})),wt.on("delete reaction",(function(e){e.comment?Tt({type:g,payload:e}):Tt({type:E,payload:e})})),s.a.render(Object(fe.jsx)(c.a.StrictMode,{children:Object(fe.jsx)(o.a,{store:It,children:Object(fe.jsx)(ee.a,{children:Object(fe.jsx)(mt,{})})})}),document.getElementById("root"))}},[[179,1,2]]]);
//# sourceMappingURL=main.83b75a39.chunk.js.map